@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Vehicle Catalog";
}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@model IEnumerable<EleVehicleDealer.DAL.EntityModels.Vehicle>
@{
    var searchTerm = ViewBag.SearchTerm as string;
    var type = ViewBag.Type as string;
    var minPrice = ViewBag.MinPrice as decimal?;
    var maxPrice = ViewBag.MaxPrice as decimal?;
}

<div class="card shadow-sm">
    <div class="card-header bg-primary text-white">
        <h4 class="mb-0">Vehicle Catalog</h4>
    </div>
    <div class="card-body">
        <!-- Bộ lọc tìm kiếm -->
        <div class="row g-3 mb-4">
            <div class="col-md-3">
                <form asp-action="Catalog" method="get" class="input-group">
                    <input type="text" name="searchTerm" class="form-control" placeholder="Search by model/type" value="@searchTerm" />
                    <button type="submit" class="btn btn-primary">Search</button>
                </form>
            </div>
            <div class="col-md-3">
                <form asp-action="Catalog" method="get" class="input-group">
                    <select name="type" class="form-select">
                        <option value="">All Types</option>
                        <option value="Sedan" selected="@(type == "Sedan")">Sedan</option>
                        <option value="SUV" selected="@(type == "SUV")">SUV</option>
                    </select>
                    <button type="submit" class="btn btn-primary">Filter by Type</button>
                </form>
            </div>
            <div class="col-md-3">
                <form asp-action="Catalog" method="get" class="input-group">
                    <input type="number" name="minPrice" class="form-control" placeholder="Min Price" value="@minPrice" />
                    <input type="number" name="maxPrice" class="form-control" placeholder="Max Price" value="@maxPrice" />
                    <button type="submit" class="btn btn-primary">Filter by Price</button>
                </form>
            </div>
            <div class="col-md-3">
                <a asp-action="Index" class="btn btn-secondary btn-lg w-100">Back to Management</a>
            </div>
        </div>

        <!-- Danh sách xe -->
        <div class="row row-cols-1 row-cols-md-3 g-4">
            @foreach (var v in Model)
            {
                <div class="col">
                    <div class="card h-100 shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title text-primary">@v.Model</h5>
                            <p class="card-text">
                                <strong>Type:</strong> @v.Type<br />
                                <strong>Color:</strong> @v.Color<br />
                                <strong>Price:</strong> $@v.Price.ToString("C")<br />
                                <strong>Created:</strong> @v.CreatedAt.ToString("dd/MM/yyyy")<br />
                                <strong>Active:</strong> @v.IsActive<br />
                                <strong>Station:</strong> @(v.StationCars.FirstOrDefault()?.StationId.ToString() ?? "N/A")
                            </p>
                            <div class="d-flex gap-2">
                                <a asp-action="Compare" asp-route-vehicleIds="@v.VehicleId" class="btn btn-info btn-sm flex-fill">Compare</a>
                                <a asp-controller="Vehicle" asp-action="Details" asp-route-id="@v.VehicleId" class="btn btn-primary btn-sm flex-fill">Details</a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>

        @if (!Model.Any())
        {
            <div class="alert alert-warning mt-4" role="alert">
                No vehicles found. <a asp-action="Index" class="alert-link">Create one</a>.
            </div>
        }
    </div>
</div>

<style>
    .card {
        border: none;
        border-radius: 10px;
        transition: all 0.3s ease;
    }

        .card:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

    .table-primary th {
        background-color: #007bff !important;
        color: white;
        border-color: #007bff;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #ffffff;
    }

    .table-striped tbody tr:nth-of-type(even) {
        background-color: #f8f9fa;
    }

    .table-hover tbody tr:hover {
        background-color: #e9ecef;
        cursor: pointer;
    }

    .btn-primary, .btn-info {
        background-color: #007bff;
        border-color: #007bff;
    }

        .btn-primary:hover, .btn-info:hover {
            background-color: #0056b3;
            border-color: #0056b3;
        }

    .btn-secondary {
        background-color: #6c757d;
        border-color: #6c757d;
    }

        .btn-secondary:hover {
            background-color: #5a6268;
            border-color: #5a6268;
        }

    .form-control, .form-select {
        border-radius: 5px;
        border-color: #ced4da;
    }

        .form-control:focus, .form-select:focus {
            border-color: #007bff;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
        }

    .input-group .btn {
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
    }

    .alert {
        border-radius: 5px;
        padding: 15px;
    }
</style>